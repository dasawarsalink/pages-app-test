{"version":3,"sources":["webpack://mainserv/./src/components/ui/market/PinPrompt.jsx","webpack://mainserv/./src/pages/user/pin.jsx"],"names":["open","submitting","onClose","onAction","message","useModalTheme","React","pin","setPin","handlePin","e","target","value","length","fullWidth","align","variant","data","visible","type","inputProps","inputMode","style","textAlign","onChange","autoFocus","user","useUserInfo","form","page","setPage","save","preventDefault","test","current","newpin","alert","submit","ajax","oldPin","oldpin","newPin","then","navigate","catch","x","response","onSubmit","ref","Link","color","to","features","billing","flexDirection","name","maxLength"],"mappings":"4LAmCA,IA7BkB,SAAC,GAA6D,IAA3DA,EAA0D,EAA1DA,KAAMC,EAAoD,EAApDA,WAAYC,EAAwC,EAAxCA,QAASC,EAA+B,EAA/BA,SAA+B,IAArBC,eAAqB,MAAX,KAAW,EAE3E,IADmBC,UACGC,WAAe,KAA9BC,EAAP,KAAYC,EAAZ,KAEMC,EAAY,SAACC,GACXA,EAAEC,OAAOC,MAAMC,QAAU,GACzBV,EAASO,EAAEC,OAAOC,OAClBJ,EAAO,KAEPA,EAAOE,EAAEC,OAAOC,QAGxB,OACI,gBAAC,IAAD,CAAQZ,KAAMA,EAAME,QAASA,EAASY,WAAS,GAC3C,gBAAC,IAAD,KACI,gBAAC,IAAD,CAAYC,MAAM,SAASC,QAAQ,MAAMZ,GAAW,iBAExD,gBAAC,IAAD,KACI,gBAAC,IAAD,CAAOa,MAAOhB,EAAYiB,QAASlB,IAC9B,kBAAM,gCACH,gBAAC,IAAD,CAAWmB,KAAK,WAAWC,WAAY,CAAEC,UAAW,UAAWC,MAAO,CAAEC,UAAW,WAC/EX,MAAOL,EAAKiB,SAAUf,EAAWK,WAAS,EAACW,WAAS,Y,6KCoDhF,UAtEa,WACT,IAAMC,GAAOC,SACPC,EAAOtB,SAAa,MAC1B,EAAwBA,WAAe,GAAhCuB,EAAP,KAAaC,EAAb,KACMC,EAAQ,SAACrB,GACXA,EAAEsB,iBACE,UAAUC,KAAKL,EAAKM,QAAQC,OAAOvB,OACnCkB,EAAQ,GAERM,MAAM,2BAERC,EAAU,SAAC9B,GAC2B,IAAD,EAAnCA,IAAQqB,EAAKM,QAAQC,OAAOvB,OAC5BkB,EAAQ,GACRQ,SAAU,YAAa,CACnBC,QAAQ,UAAAX,EAAKM,QAAQM,cAAb,eAAqB5B,QAAS,KACtC6B,OAAQb,EAAKM,QAAQC,OAAOvB,QAC7B8B,MAAK,WACJN,MAAM,sBACNO,cAAS,qBACVC,OAAM,SAAAC,GAAM,IAAD,EACVT,OAAM,UAAAS,EAAEC,gBAAF,eAAY7B,KAAKb,UAAWyC,EAAEzC,SACpC0B,EAAQ,OAGZM,MAAM,8BAGd,OACI,gBAAC,IAAD,CAAOnB,KAAMS,IACR,kBACG,gCACI,gBAAC,IAAD,MACA,wBAAMqB,SAAUhB,EAAMiB,IAAKpB,GACvB,gBAAC,IAAD,KACI,gBAAC,IAAD,KACI,gBAAC,IAAD,KACI,gBAAC,EAAAqB,KAAD,CAAMC,MAAM,UAAUC,GAAG,kBAAzB,mBAGA,gBAAC,IAAD,CAAYD,MAAM,eAAlB,wBAIPxB,EAAK0B,SAASC,SAAW,gBAAC,IAAD,CAAU/B,MAAO,CAAEgC,cAAe,WACxD,gBAAC,IAAD,CAAYvC,MAAM,SAASC,QAAQ,MAAnC,qBACA,gBAAC,IAAD,CAAWG,KAAK,WAAWoC,KAAK,SAASnC,WAAY,CAAEC,UAAW,UAAWC,MAAO,CAAEC,UAAW,UAAYiC,UAAW,GACpH1C,WAAS,KAEjB,gBAAC,IAAD,CAAUQ,MAAO,CAAEgC,cAAe,WAC9B,gBAAC,IAAD,CAAYvC,MAAM,SAASC,QAAQ,MAAnC,qBACA,gBAAC,IAAD,CAAWG,KAAK,WAAWoC,KAAK,SAASnC,WAAY,CAAEC,UAAW,UAAWC,MAAO,CAAEC,UAAW,UAAYiC,UAAW,GACpH1C,WAAS,KAEjB,gBAAC,IAAD,KACI,gBAAC,IAAD,CAAQK,KAAK,SAASH,QAAQ,YAAYkC,MAAM,UAAUpC,WAAS,GAAnE,aAMZ,gBAAC,IAAD,CAAWd,KAAM6B,GAAQ,EAAG5B,WAAqB,IAAT4B,EACpCzB,QAAQ,sBACRD,SAAUkC,EAAQnC,QAAS,kBAAM4B,EAAQ","file":"component---src-pages-user-pin-jsx-12dc3691df048ca4f638.js","sourcesContent":["import { Dialog, DialogContent, DialogTitle, Modal, Paper, TextField, Typography } from \"@material-ui/core\";\nimport * as React from \"react\";\nimport { useModalTheme } from \"../../style\";\nimport Defer from \"../Defer\";\n\n\nconst PinPrompt = ({ open, submitting, onClose, onAction, message = null }) => {\n    const modalTheme = useModalTheme();\n    const [pin, setPin] = React.useState('');\n\n    const handlePin = (e) => {\n        if (e.target.value.length >= 6) {\n            onAction(e.target.value);\n            setPin('');\n        } else {\n            setPin(e.target.value);\n        }\n    }\n    return (\n        <Dialog open={open} onClose={onClose} fullWidth>\n            <DialogTitle>\n                <Typography align=\"center\" variant=\"h6\">{message || 'Masukkan PIN'}</Typography>\n            </DialogTitle>\n            <DialogContent>\n                <Defer data={!submitting} visible={open}>\n                    {() => <>\n                        <TextField type='password' inputProps={{ inputMode: 'numeric', style: { textAlign: 'center' } }}\n                            value={pin} onChange={handlePin} fullWidth autoFocus />\n                    </>}\n                </Defer>\n            </DialogContent>\n        </Dialog>\n    );\n}\n\nexport default PinPrompt\n","import * as React from \"react\";\nimport { useUserInfo } from \"../../components/save\";\nimport Defer from \"../../components/ui/Defer\";\nimport ajax, { useFetcher } from '../../components/ajax';\nimport Navbar from \"../../components/ui/Navbar\";\nimport { Breadcrumbs, Button, FormControl, List, ListItem, ListItemSecondaryAction, ListItemText, Select, TextField, Typography } from \"@material-ui/core\";\nimport { Link, navigate } from \"gatsby\";\nimport PinPrompt from \"../../components/ui/market/PinPrompt\";\n\nconst Page = () => {\n    const user = useUserInfo();\n    const form = React.useRef(null);\n    const [page, setPage] = React.useState(0);\n    const save = ((e) => {\n        e.preventDefault();\n        if (/^\\d{6}$/.test(form.current.newpin.value))\n            setPage(1);\n        else\n            alert('Pin baru harus 6 digit');\n    });\n    const submit = ((pin) => {\n        if (pin === form.current.newpin.value) {\n            setPage(2);\n            ajax.post('/auth/pin', {\n                oldPin: form.current.oldpin?.value || null,\n                newPin: form.current.newpin.value,\n            }).then(() => {\n                alert('Berhasil disimpan');\n                navigate('/user/profile/');\n            }).catch(x => {\n                alert(x.response?.data.message || x.message);\n                setPage(0);\n            })\n        } else {\n            alert('Konfirmasi pin tidak sama');\n        }\n    });\n    return (\n        <Defer data={user}>\n            {() => (\n                <>\n                    <Navbar />\n                    <form onSubmit={save} ref={form}>\n                        <List>\n                            <ListItem>\n                                <Breadcrumbs>\n                                    <Link color=\"inherit\" to=\"/user/profile/\">\n                                        Pengaturan Akun\n                                    </Link>\n                                    <Typography color=\"textPrimary\">Atur PIN Transaksi</Typography>\n                                </Breadcrumbs>\n                            </ListItem>\n\n                            {user.features.billing && <ListItem style={{ flexDirection: 'column' }}>\n                                <Typography align=\"center\" variant=\"h6\">Masukkan PIN Lama</Typography>\n                                <TextField type=\"password\" name='oldpin' inputProps={{ inputMode: 'numeric', style: { textAlign: 'center' }, maxLength: 6 }}\n                                    fullWidth />\n                            </ListItem>}\n                            <ListItem style={{ flexDirection: 'column' }}>\n                                <Typography align=\"center\" variant=\"h6\">Masukkan PIN Baru</Typography>\n                                <TextField type=\"password\" name='newpin' inputProps={{ inputMode: 'numeric', style: { textAlign: 'center' }, maxLength: 6 }}\n                                    fullWidth />\n                            </ListItem>\n                            <ListItem>\n                                <Button type='submit' variant=\"contained\" color=\"primary\" fullWidth>\n                                    Simpan\n                                </Button>\n                            </ListItem>\n                        </List>\n                    </form>\n                    <PinPrompt open={page >= 1} submitting={page === 2}\n                        message=\"Konfirmasi PIN Baru\"\n                        onAction={submit} onClose={() => setPage(0)} />\n                </>\n            )}\n        </Defer>\n    );\n}\n\nexport default Page;\n"],"sourceRoot":""}